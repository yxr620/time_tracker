# Chrono - 使用手册

## 📱 应用概述

这是一款名为 **Chrono** 的个人时间追踪工具，帮助你线性记录每天不同时刻在做什么事情，设置每日目标，并统计各目标的时间投入情况。

**设计理念：** 记录生活流水账。例如 11:00-12:18 在学习，12:18-12:47 在吃饭，12:47-13:00 在排队……以此完整还原一天的时间使用。建议利用琐碎时间（排队、等人等）进行记录，保持记录的连续性。

**核心特性：**
- ⏱️ 实时计时追踪
- ✏️ 手动添加历史记录
- 🏷️ 活动分类（6个预设类别）
- 📊 24小时时间轴可视化
- 🎯 每日目标管理（统计时间投入，无完成/未完成指标）
- 📈 **数据分析看板**（桌面端专属）
- 📊 **趋势分析页面**（桌面端专属）
- 🎯 **目标深度分析**（桌面端专属）
- 🤖 **AI 时间助手**（桌面端专属，需配置 API Key）
- 🔄 多端同步（基于阿里云 OSS，可选）
- 📤 数据导出（JSON格式）
- 📥 数据导入（合并/替换模式）
- 💾 本地离线存储
- 📱 PWA支持（可安装到桌面）
- 💻 桌面端分栏布局
- 🌙 深色模式支持

---

## 🎯 使用场景

### 单人使用

本应用为**个人使用**设计。无论是否联网，都是一个人记录自己日常生活的时间流水。

### 离线单机使用

不配置任何云服务即可完整使用所有本地功能。数据存储在设备本地，适合只在一台设备上记录的场景。

### 多设备同步（可选）

如果你希望在手机、平板、电脑上都能记录和查看，可以配置阿里云 OSS 开启云同步。因为是单人使用，多设备之间的同步不会有复杂的冲突问题。应用已经实现了 push/pull/merge 机制，正常使用不会出现数据丢失。

### 目标管理理念

本应用的目标管理是**基于每天的时间投入统计**。每天创建目标，统计该目标关联了多少时间记录、总共花了多少时间。不存在"完成/未完成/进行中"这类状态指标——核心关注的是**你在每件事上投入了多少时间**。

---

## 🎨 界面布局

**深色模式：** 应用支持深色/浅色模式切换，会自动保存你的偏好。

### 移动端布局

应用采用底部三Tab布局：

```
┌─────────────────────────┐
│   Time Tracker           │
├─────────────────────────┤
│                         │
│    [主要内容区域]        │
│                         │
├─────────────────────────┤
│  📝记录 | 🎯目标 | ⚙️设置│
└─────────────────────────┘
```

**三个主要Tab页面：**
1. **📝 记录** - 时间追踪和记录管理
2. **🎯 目标** - 每日目标设置和统计
3. **⚙️ 设置** - 数据导出/导入和云同步

### 桌面端布局（屏幕宽度 ≥ 1024px）

桌面端采用侧边栏导航 + 主内容区的分栏布局：

```
┌──────────┬──────────────────────────────┐
│          │                              │
│  📊 分析 │                              │
│  📝 记录 │       [主要内容区域]          │
│  🎯 目标 │                              │
│  🤖 AI   │                              │
│  📤 同步 │                              │
│          │                              │
└──────────┴──────────────────────────────┘
```

**六个主要页面：**
1. **📊 分析** - 数据分析看板（桌面端专属）
   - 点击「类别趋势分析」卡片可进入趋势页面
   - 点击「目标深度分析」卡片可进入目标分析页面
2. **📝 记录** - 时间追踪和记录管理
3. **🎯 目标** - 每日目标设置和统计
4. **🤖 AI** - AI 时间助手对话界面（桌面端专属）
5. **📤 同步** - 数据导出/导入和云同步

---

## 📝 记录页面（第一个Tab）

**日期同步说明**：记录页面、时间轴、目标页面共享同一选中日期。保存记录后保持当前日期不变，方便连续录入。

### 1. 实时计时功能

**开始计时：**
1. 输入活动名称（如："读论文"、"锻炼"）
2. **选择类别**（必选）：学习、工作、运动、娱乐、日常、休息
3. （可选）选择关联的目标
4. 选择开始方式：
   - **接续上次**（主按钮）：从上一个记录的结束时间开始（最常用）
   - **手动添加**：打开手动添加记录弹窗
   - **从现在开始**（底部链接）：立即开始计时

**正在计时时：**
- 显示当前活动名称
- 实时显示已用时间（HH:MM:SS格式）
- 点击"停止"按钮结束计时并保存记录

**关联目标：**
- 在开始计时前，可以选择关联今天的某个目标
- 如果今天没有目标，会显示提示
- 可以选择"无"来不关联目标

### 2. 手动添加记录

**使用场景：** 补充过去的时间记录

**操作步骤：**
1. 点击追踪区域的"手动添加"按钮
2. 在弹窗中填写：
   - **活动名称**（必填）
   - **类别**（必选）：学习、工作、运动、娱乐、日常、休息
   - **关联目标**（可选，从该日期的目标中选择）
   - **开始时间**（点击选择，或使用快捷按钮）
   - **结束时间**（点击选择，或使用快捷按钮）
3. 点击"保存"按钮

**快捷时间按钮：**
- **现在** - 设为当前时间
- **5分钟前** - 当前时间减5分钟
- **15分钟前** - 当前时间减15分钟
- **30分钟前** - 当前时间减30分钟

### 3. 24小时时间轴可视化

**功能说明：**
- 以进度条形式展示一天24小时的时间使用情况
- 可视化显示各个活动的时间分布
- 支持日期切换，查看历史数据

**显示内容：**
- **日期导航**：
  - 左右箭头切换前一天/后一天
  - 当前日期显示（YYYY-MM-DD格式）
  - "今天"快捷按钮（查看历史时显示）
  - 与目标页和录入表单共享日期，切换后跨页面保持
  
- **24小时时间轴**：
  - 横向进度条（0时-24时）
  - 时间刻度标签（0、6、12、18、24）
  - 彩色时间块表示不同活动（按类别颜色）
  - 空白区域表示未记录时间
  
- **当前时间指示**（今天）：
  - 红色竖线标记当前时刻
  - 顶部红点指示当前位置
  
- **统计信息**：
  - 已记录项数
  - 总时长（小时）

**交互操作：**
- **点击时间块**：显示活动详情气泡，同时设置开始时间为该记录结束时间
  - 活动名称
  - 时间范围（HH:MM - HH:MM）
  - 持续时长
- **点击空白间隙**：自动填充间隙的开始和结束时间
- **切换日期**：查看不同日期的时间分布，开始时间自动更新为该日期最后记录的结束时间
- **鼠标悬停**（桌面端）：时间块放大显示

### 4. 记录列表

**显示内容：**
- 按时间倒序显示当天所有记录
- 每条记录显示：
  - 活动名称
  - 时间范围（HH:MM - HH:MM）
  - 持续时长（X小时Y分钟）
  - 类别标签
  - 关联的目标（如果有）

**操作记录：**
- **左滑**查看操作按钮
- **编辑**：修改记录的活动名称、类别、时间、关联目标
- **删除**：删除该记录（需要确认）

---

## 🎯 目标页面（第二个Tab）

> 目标页面的核心理念：**统计每个目标的时间投入**，而非追踪目标完成状态。

### 1. 日期与时间注入矩阵

页面顶部为一张**紧凑卡片**，集日期切换、当日统计、月历矩阵于一体。

**日期切换行：**
- 单行显示：`◀  📅 日期 · 累计时长  ▶`
- 点击左右箭头切换前/后一天
- 点击中间区域展开/收起**时间注入矩阵**
- 日期选择与记录页/时间轴保持同步

**时间注入矩阵（可收起）：**
- 类似 GitHub 贡献图的**月历网格**，每个小方块代表一天
- 当天有目标时间投入时，方块内会从底部向上填充颜色条，高度正比于投入时长——越多越满，如同时间被"注入"到格子中
- 点击任意日期方块可快速跳转到该日
- 选中日期以蓝色边框高亮，今天以红色边框标记
- 内置月份导航箭头，可翻看历史月份

**注入模式切换：**
- **相对模式**（默认）：以当月最大投入日为 100%，其余日期按比例填充
- **绝对模式**：以 24 小时（1440 分钟）为 100%
- 通过矩阵下方的"相对/绝对"按钮切换

**回到今天：**
- 查看非今天时显示"回到今天"按钮，点击快速返回

### 2. 目标管理

**添加目标：**
1. 点击右上角"添加目标"按钮
2. 输入目标名称（如："读论文"、"锻炼"、"处理工作"）
3. 点击"确认添加"

**查看目标：**
- 目标列表显示当天所有目标
- 每个目标显示目标名称和已花费时长（实时统计）

**编辑 / 删除目标：**
- 点击目标右侧的编辑或删除按钮操作
- 删除目标不会影响已关联的时间记录

### 3. 统计汇总

**时长计算规则：**
- 只统计已完成且关联了目标的记录（有结束时间、有 goalId）
- 正在进行的记录不计入统计

---

## 📊 数据分析看板（桌面端专属）

> 💡 该功能仅在桌面端（屏幕宽度 ≥ 1024px）可用，点击侧边栏的「分析」进入。

### 1. 功能概述

数据分析看板提供全面的时间使用可视化分析，帮助你了解时间分配情况和工作习惯。

**主要功能：**
- KPI 指标卡片：快速了解关键数据
- 分类别趋势图：追踪各类别时间投入变化
- 目标分布图：查看时间在各目标上的分配
- 类别分布饼图：直观展示各类别占比
- 时段分布图：分析一天中的工作习惯

### 2. 时间范围选择

在页面右上角可以选择分析的时间范围：
- **最近7天**：查看近一周数据
- **最近30天**：查看近一个月数据（默认）
- **自定义**：自由选择开始和结束日期

### 3. KPI 指标卡片

显示三个关键指标（最常用目标会自动忽略"无目标"）：

| 指标 | 说明 |
|------|------|
| 总时长 | 选定时间范围内的累计记录时长，显示记录条数 |
| 活跃天数 | 有记录的天数，以及平均每天时长 |
| 最常用目标 | 时间投入最多的目标名称（忽略"无目标"） |

### 4. 类别趋势分析入口

**功能说明：**
- 在看板中显示「类别趋势分析」入口卡片
- 点击卡片可进入详细的趋势分析页面
- 卡片预览当前有记录的类别标签

**趋势分析页面功能：**

**1. 总体叠加面积图**
- 展示所有类别时间在日期范围内的分布
- 不同颜色代表不同类别
- 可直观看到每天总时长及各类别占比变化

**2. 周度对比功能**
- 自动计算最近 3 个完整周（周日-周六）的数据
- 包含 3 个可视化组件：

| 图表 | 说明 |
|------|------|
| 类别纵向对比图 | 分组柱状图，每个类别一行，对比 3 周的时长变化 |
| 周度堆叠柱状图 | 每周总时长按类别堆叠显示，直观对比周总量 |
| 本周变化摘要 | 显示本周 vs 上周变化最大的 Top 3 类别，红色/绿色标注增减 |

**3. 单类别趋势折线图**
- 每个类别独立显示一个时长趋势折线图
- 显示当天未记录的时间，计入「未分类」
- 平均值参考线辅助分析
- 支持 7/30 天及自定义日期范围

**显示统计：**
- 每个类别的总计时长
- 每个类别的日均时长

### 5. 目标分布柱状图

**功能说明：**
- 展示时间投入最多的 Top 10 目标
- 横向柱状图，按时长降序排列
- 单位为小时
- "无目标"不绘制柱状图，会在标题旁以徽标标注其时长

**使用场景：**
- 了解哪些目标占用了最多时间
- 评估时间分配是否合理

### 6. 类别分布饼图

**功能说明：**
- 以饼图形式展示各类别的时间占比
- 颜色与应用内预设类别颜色对应
- 显示具体百分比和时长

### 7. 时段分布图

**功能说明：**
- 展示 24 小时内各时段的时间分布
- 柱状图形式，X 轴为 0:00 - 23:00
- 帮助分析一天中的工作习惯和高效时段

### 8. 目标深度分析入口

**功能说明：**
- 在看板中显示「目标深度分析」入口卡片
- 点击可进入详细的目标分析页面
- 提供超越简单 Top 10 分布的深度目标洞察

**目标深度分析页面功能：**

**1. 智能目标聚类**
- 自动将相似目标归为同一「簇」（如"开发 app"、"修复 app bug"、"测试 app" 归为一组）
- 无需手动分组，算法自动识别

**2. 时间投入概览**
- 总投入时长：选定时间范围内关联目标的总时长
- 日均投入：总投入 ÷ 日期范围天数
- 目标覆盖率：有目标关联的时间占比
- 活跃聚类数：有时间记录的聚类数量

**3. 目标时间分布**
- 水平条形排行图展示 Top 10 目标簇的时间占比
- 其余目标簇合并为「其他」
- 每条显示时长和百分比

**4. 未关联事件建议**
- 识别无目标记录中可能与现有目标簇相关的事件
- 提供快速关联入口（开发中）

---

## 🤖 AI 时间助手（桌面端专属）

> 💡 该功能仅在桌面端（屏幕宽度 ≥ 1024px）可用，点击侧边栏的「AI」进入。
> 需要先配置 AI 服务商的 API Key 才能使用。

### 1. 功能概述

AI 时间助手是一个基于大语言模型的对话界面，可以用自然语言查询和分析你的时间记录数据。

**你可以问的问题包括：**
- "昨天做了什么？"
- "上周花在学习上多少时间？"
- "对比1月和2月的时间分配"
- "本月哪个类别花的时间最多？"
- "最近7天的工作效率如何？"
- "生成本周报告"

**核心优势：**
- 支持多时间段对比查询（如"对比1月和2月"会分别查询两个月的数据）
- 支持按类别、目标筛选（如"上周花在运动上的时间"）
- 数据完全在本地处理，仅将统计摘要发送给 AI，保护隐私

### 2. 首次配置

首次使用时，点击对话界面的输入框或右上角齿轮图标，会弹出设置面板：

1. **选择服务商**：从下拉列表选择（通义千问、Gemini、智谱 GLM、Kimi、MiniMax、OpenAI，或自定义）
2. **填写 API Key**：输入你在对应平台申请的 API 密钥
3. **选择模型**：从该服务商可用模型列表中选择
4. 点击「完成」保存

> 💡 API Key 仅保存在浏览器本地，不会上传到任何服务器。每个服务商的配置独立保存，切换时自动恢复。

**高级设置：** 点击「高级设置」可修改 Base URL，用于接入 Ollama 本地模型或其他 OpenAI 兼容代理服务。

### 3. 使用方式

**快捷问题：**
- 在欢迎界面直接点击预设的快捷问题按钮即可开始
- 对话过程中，输入框上方也会显示常用的快捷按钮

**自由提问：**
- 在输入框输入任何关于时间记录的问题
- 按 Enter 发送（Shift + Enter 换行）
- 点击发送按钮发送

### 4. 对话界面说明

**AI 回答过程：**
- 📋 准备上下文 — AI 正在了解你的数据环境
- 💭 分析问题 — AI 正在理解你的意图
- 🔧 查询数据 — AI 正在从你的本地数据库中检索记录（会显示具体查询的时间范围和筛选条件）
- ✍️ 生成回答 — AI 正在撰写分析结果

**其他操作：**
- 🗑️ 清空对话：点击右上角垃圾桶图标
- ⏹ 停止生成：在 AI 回答过程中，点击停止按钮可中断生成
- ⚙️ 修改设置：点击右上角齿轮图标

### 5. 使用建议

- **生成报告**：每周/月使用「生成本周报告」或「生成本月报告」获取结构化的时间分析
- **对比分析**：使用"对比 X 和 Y"格式进行跨时间段对比
- **精确筛选**：在提问中指明类别或目标名称，获取更精准的分析
- **连续对话**：AI 会记住最近的对话上下文（最多 6 条），可以基于前面的回答追问

---

## ⚙️ 设置页面（第三个Tab）

### 1. 多端同步（可选）

**功能说明：**
- 基于阿里云 OSS 的同步功能
- 支持手机和电脑之间同步数据
- 需要在 `.env` 文件中配置阿里云 OSS 参数

**快速了解：**
- 配置 OSS 后，在设置页面可使用同步功能
- 应用启动时会自动拉取（Pull）远端数据
- 提供增量同步（推荐日常使用）和强制全量同步（数据恢复）
- 在另一台设备上配置相同的 OSS，同步后数据保持一致
- 支持高级维护：重置同步状态、清理操作日志、清理软删除记录
- 不配置 OSS 不影响其他功能

**同步操作：**
- **增量同步**：只同步变化的数据，速度快，推荐日常使用
- **增量推送 / 增量拉取**：分别只推送或只拉取
- **强制全量同步**：完整重新同步所有数据
- **强制全量推送 / 强制全量拉取**：用于数据恢复等特殊情况

**详细说明：** 请查看 [多端同步功能文档](./sync.md)

### 2. 数据导入

**功能说明：**
- 从之前导出的JSON文件中恢复数据
- 支持两种导入策略：合并模式和替换模式
- 适合数据备份恢复和离线数据同步

**合并模式（推荐）**
- 保留现有数据，导入新数据
- 相同ID的记录会被更新为导入文件中的版本
- 适合场景：补充历史数据、合并多个设备的数据

**替换模式**
- ⚠️ 清空所有现有数据（记录和目标），导入文件中的所有数据
- 此操作不可撤销
- 适合场景：在新设备上首次恢复数据、完全重置应用数据

**操作步骤：**
1. 点击"📥 导入数据"按钮
2. 选择导入策略（合并导入 / 替换导入）
3. 选择之前导出的JSON文件
4. 等待导入完成，查看导入结果报告

### 3. 全量导出

**功能说明：**
- 导出所有时间记录、目标和类别为JSON格式
- 文件名格式：`time-tracker-full-YYYYMMDD-HHmmss.json`
- 适合数据备份

### 4. 增量导出

**功能说明：**
- 只导出自上次同步后的新增或修改的数据
- 文件名格式：`time-tracker-sync-YYYYMMDD-HHmmss.json`
- 适合定期备份，文件更小

---

## 💡 使用技巧

### 1. 高效记录时间

**推荐工作流：**
```
1. 每天早上在"目标"页面设置今日目标（如：学习、工作、锻炼）
2. 开始工作时，在"记录"页面开始计时：
   - 输入活动名称
   - 选择类别
   - 选择对应目标
   - 点击"接续上次"开始（最常用）
3. 完成一项活动后，停止计时
4. 继续下一项活动，重复步骤2（活动自动接续）
5. 利用碎片时间（排队、等人）补充之前遗漏的记录
6. 随时查看24小时时间轴，直观了解时间分布
7. 晚上查看"目标"页面，回顾各目标的时间投入
```

### 2. 补充历史记录

**适用情况：**
- 忘记开始计时
- 回顾补录过去的时间
- 批量添加一天的记录

**操作建议：**
- 使用快捷时间按钮快速设置时间
- 先创建当天的目标，再添加记录并关联
- 点击时间轴上的空白间隙，自动填充间隙时间

### 3. 目标管理建议

**设置目标的最佳实践：**
- 目标名称简洁明确（2-5个字）
- 不要设置太多目标（建议3-5个）
- 可以为"其他"或"杂项"设置一个目标
- 每天按实际情况重新创建目标

**理解目标的定位：**
- 目标只统计时间投入，没有"完成/未完成"的概念
- 专注于了解"我在这件事上花了多少时间"
- 通过桌面端的数据分析看板查看长期的时间投入趋势

### 4. 数据管理

**日常备份：**
- 推荐配置 OSS 云同步，自动保持数据安全
- 如未配置云同步，建议定期使用"增量导出"备份数据
- 重要时刻使用"全量导出"创建完整备份

**多设备同步：**
- **推荐方式**：配置阿里云 OSS，所有设备使用相同配置，日常增量同步即可
- **离线方式**：导出JSON文件，传输到另一台设备后使用"合并模式"导入

**数据恢复：**
- 新设备首次使用：配置相同 OSS 后同步，或使用"替换模式"导入全量备份
- 误删除恢复：从最近的备份文件中使用"合并模式"导入

---

##  快速上手

### 5分钟入门
1. 打开应用，进入"目标"页面
2. 添加今天的第一个目标："学习"
3. 回到"记录"页面
4. 输入活动"读书"
5. 选择类别"学习"
6. 选择目标"学习"
7. 点击"从现在开始"
8. 做你的事情...
9. 完成后点击"停止"
10. 查看24小时时间轴上的彩色时间块
11. 查看记录列表中的新记录
12. 切换到"目标"页面，查看"学习"目标的时长统计

### 第一天完整流程
```
早上9:00
├─ 打开应用
├─ 目标页面：添加"工作"、"学习"、"锻炼"三个目标
├─ 记录页面：开始"晨会"，类别选"工作"，关联"工作"目标
└─ ...继续一天的活动，每切换活动就停止+开始新计时

晚上10:00
├─ 查看目标页面，回顾各目标时间投入
├─ 查看时间轴，看看一天的时间分布
└─ 完成！
```

---

## 📞 常见问题

**Q: 如何快速了解一天的时间分布？**
A: 查看记录页面的24小时时间轴，彩色时间块直观展示各类活动的时间占用情况。

**Q: 时间轴上的空白是什么意思？**
A: 空白区域表示该时段没有记录任何活动。点击空白间隙可以快速补录。

**Q: 忘记停止计时怎么办？**
A: 左滑记录点击编辑，手动修改结束时间。

**Q: 类别可以自定义吗？**
A: 当前版本提供6个预设类别（学习、工作、运动、娱乐、日常、休息），暂不支持自定义。

**Q: 目标可以跨天使用吗？**
A: 目标是按日期的，每天需要重新创建。这是设计上的选择——关注每天的时间投入。

**Q: 数据存在哪里？**
A: 存储在设备本地。可以通过云同步在多设备间保持数据一致。

**Q: 如何在多设备间同步？**
A: 推荐使用云同步功能（需配置阿里云 OSS）：
1. 在所有设备上配置相同的 OSS 参数
2. 日常使用时进行增量同步即可
3. 首次同步会自动从其他设备恢复数据
4. 详见 [sync.md](./sync.md)

如果未配置 OSS，也可使用导出/导入功能手动同步。

**Q: 删除目标会删除记录吗？**
A: 不会。已关联该目标的记录会保留，但目标信息不再显示。

**Q: 导入数据会覆盖现有记录吗？**
A: 取决于导入策略：
- **合并模式**：保留现有数据，相同ID的记录会被更新
- **替换模式**：清空所有数据后导入新数据

**Q: AI 时间助手需要什么？**
A: 需要在桌面端使用，并配置一个 AI 服务商的 API Key（支持通义千问、Gemini、OpenAI 等多个服务商）。API Key 只存储在本地。

---

## ⚠️ 注意事项

### 使用限制
1. **进行中的记录**：同一时间只能有一个正在进行的记录
2. **时间验证**：结束时间必须晚于开始时间
3. **类别必选**：每条记录必须选择一个类别
4. **目标匹配**：只能选择与记录日期相同的目标
5. **活动名称**：不能为空

### 数据安全
- 所有数据默认存储在本地设备，不会自动上传
- 配置 OSS 后仅同步到你自己的阿里云存储
- AI 功能的 API Key 仅存储在本地
- **重要**：定期备份数据（云同步或导出JSON）
- 卸载应用或清除浏览器数据会清除本地数据

---

**感谢使用 Chrono！**
