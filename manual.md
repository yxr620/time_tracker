# 时间追踪工具 - 使用手册

## 📱 应用概述

这是一款个人时间追踪工具，帮助你记录日常活动的时间花费，设置和管理每日目标，并统计时间使用情况。

**核心特性：**
- ⏱️ 实时计时追踪
- ✏️ 手动添加历史记录
- 🎯 每日目标管理
- 📊 时间统计分析
- 📤 数据导出（JSON/Excel）
- 💾 本地离线存储
- 📱 PWA支持（可安装到桌面）

---

## 🎨 界面布局

应用采用底部三Tab布局：

```
┌─────────────────────────┐
│   时间追踪工具           │
├─────────────────────────┤
│                         │
│    [主要内容区域]        │
│                         │
├─────────────────────────┤
│  📝记录 | 🎯目标 | 📤导出│
└─────────────────────────┘
```

### 三个主要Tab页面：
1. **📝 记录** - 时间追踪和记录管理
2. **🎯 目标** - 每日目标设置和统计
3. **📤 导出** - 数据导出功能

---

## 📝 记录页面（第一个Tab）

### 1. 实时计时功能

**开始计时：**
1. 在"开始新的追踪"区域输入活动名称（如："读论文"、"锻炼"）
2. （可选）选择关联的目标
3. 点击两个按钮之一：
   - **从现在开始**：立即开始计时
   - **接续上次**：从上一个记录的结束时间开始（适合连续记录）

**正在计时时：**
- 显示当前活动名称
- 实时显示已用时间（HH:MM:SS格式）
- 点击"停止"按钮结束计时并保存记录

**关联目标：**
- 在开始计时前，可以选择关联今天的某个目标
- 如果今天没有目标，会显示提示
- 可以选择"无"来不关联目标

### 2. 手动添加记录

**使用场景：** 补充过去的时间记录

**操作步骤：**
1. 点击"手动添加记录"按钮
2. 在弹窗中填写：
   - **活动名称**（必填）
   - **关联目标**（可选，从该日期的目标中选择）
   - **开始时间**（点击选择，或使用快捷按钮）
   - **结束时间**（点击选择，或使用快捷按钮）
3. 点击"保存"按钮

**快捷时间按钮：**
- **现在** - 设为当前时间
- **5分钟前** - 当前时间减5分钟
- **15分钟前** - 当前时间减15分钟
- **30分钟前** - 当前时间减30分钟

### 3. 记录列表

**显示内容：**
- 按时间倒序显示所有记录
- 每条记录显示：
  - 活动名称
  - 时间范围（HH:MM - HH:MM）
  - 持续时长（X小时Y分钟）
  - 关联的目标（如果有，显示为蓝色标签）

**操作记录：**
- **左滑**查看操作按钮
- **编辑**：修改记录的活动名称、时间、关联目标
- **删除**：删除该记录（需要确认）

**编辑记录功能：**
1. 左滑记录，点击"编辑"
2. 可以修改：
   - 活动名称
   - 关联目标（可添加、更换或移除）
   - 开始时间
   - 结束时间
3. 点击"保存"确认修改

---

## 🎯 目标页面（第二个Tab）

### 1. 日期选择

**切换日期：**
- 点击左右箭头切换到前一天/后一天
- 点击中间的日期区域，打开日期选择器，跳转到任意日期
- 显示"今天"/"昨天"/"明天"或具体日期

**回到今天：**
- 当查看非今天的日期时，会显示"回到今天"按钮
- 点击快速返回今天的目标

### 2. 目标管理

**添加目标：**
1. 点击右上角"添加目标"按钮
2. 输入目标名称（如："读论文"、"锻炼"、"处理工作"）
3. 确认日期（默认为当前选中的日期）
4. 点击"确认添加"

**查看目标：**
- 目标列表显示当天所有目标
- 每个目标显示：
  - 目标名称
  - 已花费时长（实时统计，格式：X小时Y分钟）
  - 花费时长为0分钟也会显示（表示目标已创建但还没开始）

**删除目标：**
- 点击目标右侧的删除按钮
- 确认后删除（注意：已关联该目标的记录不会被删除）

### 3. 统计汇总

**今日总计：**
- 在目标列表上方显示当日所有目标的累计时长
- 格式：X小时Y分钟 / X分钟
- 实时更新

**时长计算规则：**
- 只统计已完成的记录（有结束时间）
- 正在进行的记录不计入统计
- 按目标ID关联计算

---

## 📤 导出页面（第三个Tab）

### 1. 导出为JSON

**功能说明：**
- 导出所有时间记录为JSON格式
- 包含完整的数据结构
- 适合数据备份和程序化处理

**操作步骤：**
1. 点击"导出为 JSON"按钮
2. 选择保存位置
3. 文件名格式：`time-entries-YYYYMMDD-HHMMSS.json`

**JSON数据结构示例：**
```json
[
  {
    "id": "uuid-string",
    "activity": "读论文",
    "startTime": "2024-11-03T10:00:00.000Z",
    "endTime": "2024-11-03T11:30:00.000Z",
    "goalId": "goal-uuid",
    "createdAt": "2024-11-03T10:00:00.000Z",
    "updatedAt": "2024-11-03T11:30:00.000Z"
  }
]
```

### 2. 导出为Excel

**功能说明：**
- 导出为Excel表格格式（.xlsx）
- 数据自动格式化为表格
- 适合查看和分析

**操作步骤：**
1. 点击"导出为 Excel"按钮
2. 选择保存位置
3. 文件名格式：`time-entries-YYYYMMDD-HHMMSS.xlsx`

**Excel表格列：**
| 列名 | 说明 |
|------|------|
| 活动 | 活动名称 |
| 开始时间 | YYYY-MM-DD HH:mm 格式 |
| 结束时间 | YYYY-MM-DD HH:mm 格式 |
| 持续时长(分钟) | 数值格式，便于计算 |
| 目标ID | 关联的目标ID（如果有） |

### 3. 复制JSON到剪贴板

**使用场景：** 导出功能失败时的备用方案

**操作步骤：**
1. 点击"复制 JSON 到剪贴板"按钮
2. 数据已复制，可以粘贴到文本编辑器
3. 手动保存为文件

---

## 💡 使用技巧

### 1. 高效记录时间

**推荐工作流：**
```
1. 每天早上在"目标"页面设置今日目标
2. 开始工作时，在"记录"页面开始计时，选择对应目标
3. 完成一项活动后，停止计时
4. 继续下一项活动，使用"接续上次"功能
5. 晚上查看"目标"页面的统计结果
```

### 2. 补充历史记录

**适用情况：**
- 忘记开始计时
- 回顾过去的时间使用
- 批量添加一天的记录

**操作建议：**
- 使用快捷时间按钮快速设置时间
- 先创建当天的目标，再添加记录并关联
- 按时间顺序从早到晚添加

### 3. 目标管理建议

**设置目标的最佳实践：**
- 目标名称简洁明确（2-5个字）
- 不要设置太多目标（建议3-5个）
- 可以为"其他"或"杂项"设置一个目标
- 每天复查和调整目标

**目标不设置时长的优势：**
- 灵活性高，不受限制
- 专注于实际时间花费
- 避免目标压力
- 更符合实际工作场景

### 4. 数据管理

**定期备份：**
- 建议每周导出一次数据
- JSON格式保留完整信息
- Excel格式便于查看分析

**数据清理：**
- 通过左滑删除错误记录
- 编辑功能修正不准确的时间
- 删除目标不会影响已有记录

---

## 🔧 技术特性

### 本地存储
- 使用IndexedDB存储数据
- 容量大（几百MB到几GB）
- 支持离线使用
- 数据永久保存在设备上

### PWA支持
- 可以安装到手机桌面
- 离线可用
- 类似原生应用体验
- 自动更新

### 键盘适配
- 输入时自动隐藏底部Tab栏
- 避免键盘遮挡内容
- 支持Android和iOS

---

## 📋 数据说明

### 数据结构

**TimeEntry（时间记录）：**
```typescript
{
  id: string;              // 唯一标识
  activity: string;        // 活动名称
  startTime: Date;         // 开始时间
  endTime: Date | null;    // 结束时间（进行中时为null）
  goalId: string | null;   // 关联的目标ID（可选）
  createdAt: Date;         // 创建时间
  updatedAt: Date;         // 更新时间
}
```

**Goal（目标）：**
```typescript
{
  id: string;        // 唯一标识
  name: string;      // 目标名称
  date: string;      // 日期（YYYY-MM-DD）
  color: string;     // 颜色标识
  createdAt: Date;   // 创建时间
  updatedAt: Date;   // 更新时间
}
```

### 数据关系
- 记录通过`goalId`关联目标
- 一个目标可以有多条记录
- 删除目标不会删除记录（goalId保留）
- 记录的目标必须与记录日期匹配

---

## ⚠️ 注意事项

### 使用限制
1. **进行中的记录**：同一时间只能有一个正在进行的记录
2. **时间验证**：结束时间必须晚于开始时间
3. **目标匹配**：只能选择与记录日期相同的目标
4. **活动名称**：不能为空

### 数据安全
- 数据存储在本地设备，不会上传到服务器
- 卸载应用会清除所有数据
- **重要**：定期导出数据进行备份

### 浏览器兼容性
- 推荐使用Chrome、Safari、Edge等现代浏览器
- 需要支持IndexedDB
- Android可以打包为原生应用

---

## 🚀 快速上手

### 5分钟入门
1. 打开应用，进入"目标"页面
2. 添加今天的第一个目标："学习"
3. 回到"记录"页面
4. 输入活动"读书"，选择目标"学习"
5. 点击"从现在开始"
6. 做你的事情...
7. 完成后点击"停止"
8. 查看记录列表中的新记录
9. 切换到"目标"页面，查看"学习"目标的时长统计

### 第一天完整流程
```
早上9:00
├─ 打开应用
├─ 目标页面：添加"工作"、"学习"、"锻炼"三个目标
├─ 记录页面：开始"晨会"，关联"工作"目标
└─ ...继续一天的活动

晚上10:00
├─ 查看目标页面的统计
├─ 导出页面：导出今日数据
└─ 完成！
```

---

## 📞 常见问题

**Q: 忘记停止计时怎么办？**
A: 左滑记录点击编辑，手动修改结束时间。

**Q: 可以跨天计时吗？**
A: 不建议。建议在23:59停止，第二天00:00重新开始。

**Q: 目标可以重复使用吗？**
A: 目标是按日期的，每天需要重新创建。未来可能支持模板功能。

**Q: 数据存在哪里？**
A: 存储在浏览器的IndexedDB中，每个设备独立。

**Q: 如何在多设备间同步？**
A: 目前不支持。可以通过导出/导入JSON来手动同步。

**Q: 删除目标会删除记录吗？**
A: 不会。已关联该目标的记录会保留goalId，但目标信息不再显示。

---

## 📝 版本信息

**当前版本：** v1.0.0

**更新日志：**
- ✅ 基础时间追踪功能
- ✅ 目标管理功能
- ✅ 数据导出功能
- ✅ 三Tab布局优化
- ✅ PWA支持

**未来计划：**
- 📅 周统计/月统计
- 📊 可视化图表
- 🎨 目标模板
- 🔄 云端同步（可选）
- 🏷️ 活动标签系统
- 📱 通知提醒功能

---

## 💻 开发信息

**技术栈：**
- React 18 + TypeScript
- Ant Design Mobile
- Dexie.js (IndexedDB)
- Zustand (状态管理)
- Day.js (时间处理)
- Vite (构建工具)
- Capacitor (原生应用打包)

**项目结构：**
```
src/
├── components/
│   ├── RecordsPage/      # 记录页面（集成）
│   ├── TimeTracker/      # 计时器组件
│   ├── EntryList/        # 记录列表
│   └── GoalManager/      # 目标管理
├── stores/               # 状态管理
├── services/             # 业务逻辑
│   ├── db.ts            # 数据库
│   └── export.ts        # 导出功能
└── App.tsx              # 主应用
```

**本地开发：**
```bash
npm run dev          # 启动开发服务器
npm run build        # 构建生产版本
npx cap copy         # 复制到原生项目
```

---

## 📄 许可证

本项目仅供个人学习和使用。

---

**感谢使用时间追踪工具！**

如有问题或建议，欢迎反馈。
